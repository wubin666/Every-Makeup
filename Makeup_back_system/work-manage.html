<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="http://g.alicdn.com/bui/bui/1.1.21/css/bs3/dpl.css" rel="stylesheet">
    <link href="http://g.alicdn.com/bui/bui/1.1.21/css/bs3/bui.css" rel="stylesheet">
    <title>Document</title>
    <style>
    .bui-grid-hd-inner{
        text-align: center;
    }
    .bui-grid-table .bui-grid-hd-title{
        padding: 0px;
    }

    .inputDate,.inputText{
		width:120px;
	}
	.btn1{
		width:60px;
		height:21px;
		background-color: #5eb95e;
		border:0px;
	}
	.btn1Span{
		color:white;
	}
	.div1{
		width:100%;
		height:40px;
		background-color: #f5fafe;
		padding-top:5px;
		margin-top:1%; margin-bottom: 1%;
	}
	.piliang{
		width:80px;
		height:35px;
		margin-left: 20px;
		background-color: #dd514c;
		border:0px;
	}
	.piliang span{
		color: white;
	}
	.addUser{
		width:80px;
		height:35px;
		background-color: #5a98de;
		border:0px;
		margin-left: 180px;
        margin-top:15px;
	}
	.addUser span{
		color:white;
	}
	.dataSpan{
		float: right;
		margin-right: 20px;
	}
	.workTr th{
		background-color: rgba(247, 206, 206, 0.5);
	}
	.content-top-search{
		margin-left: 20px;
		margin-top: 10px;
	}
    .demo-content{
        margin-left:180px;
    }
    </style>
</head>
<body>
	<div class="content-top-search">
    <!-- <p name="view_frame">作品管理</p> -->
    日期范围：
	<input type="text" id="logmin" class="inputDate" > 
	- 
	<input type="text" id="logmax" class="inputDate" >
	<input type="text" placeholder="输入关键词" class="inputText">
	<button type="submit" class="btn1">
		<span class="btn1Span">
			搜索
		<span>
	</button>
    </div>
	<div class="div1">
		<button class="piliang"><span>批量处理</span></button>
		<span class="dataSpan">共有数据：54条</span>
    </div>

    <div class="demo-content">
        <div class="row">
            <div class="span16">
                <div id="grid">
                          
                </div>
            </div>
        </div>
    </div>     
    <button class="addUser"><span>添加作品</span></button>

</body>
</html>


<script src="http://g.tbcdn.cn/fi/bui/jquery-1.8.1.min.js"></script>
<script src="http://g.alicdn.com/bui/seajs/2.3.0/sea.js"></script>
<script src="http://g.alicdn.com/bui/bui/1.1.21/config.js"></script>
<script type="text/javascript">
    BUI.use(['bui/grid','bui/data'],function(Grid,Data){
        var 
      Store = Data.Store,
      enumObj = {"1" : "选项一","2" : "选项二","3" : "选项三"},
      columns = [
        {title : '作品编号',dataIndex :'a',editor : {xtype : 'number',validator : validFn}}, //editor中的定义等用于 BUI.Form.Field.Text的定义
        {title : '每妆号', dataIndex :'c',editor : {xtype : 'number',rules : {required : true}}},
        {title : '发布时间',dataIndex :'f',editor : {xtype : 'date',validator : validFn}},
        {title : '操作',dataIndex : 'g',editor : {xtype : 'text',validator : validFn}}


      ],
      data = [{a:'20183223',c:'20185423',f:'2018-05-12',g:'✎编辑'},{a:'20183545',c:'20186845',f:'2018-03-12',g:'✎编辑'},{a:'20184755',c:'20188722',f:'2018-05-18',g:'✎编辑'},{a:'20186478',c:'20184299',f:'2018-02-12',g:'✎编辑'}]
    function valid(value){
      if(value === '1'){
        return '不能选择1';
      }
    }
    var editing = new Grid.Plugins.CellEditing({
      triggerSelected : false //触发编辑的时候不选中行
    }),
      store = new Store({
        data : data,
        autoLoad:true
      }),
      grid = new Grid.Grid({
        render:'#grid',
        columns : columns,
        width : 700,
        forceFit : true,
        tbar:{ //添加、删除
            items : [{
              btnCls : 'button button-small',
              text : '<i class="icon-plus"></i>添加',
              listeners : {
                'click' : addFunction
              }
            },
            {
              btnCls : 'button button-small',
              text : '<i class="icon-remove"></i>删除',
              listeners : {
                'click' : delFunction
              }
            }]
        },
        plugins : [editing,Grid.Plugins.CheckSelection,Grid.Plugins.ColumnChecked],
        store : store
      });

    grid.render();

    

    function validFn (value,obj) {
      var records = store.getResult(),
        rst = '';
      BUI.each(records,function (record) {
        if(record.a == value && obj != record){
          rst = '文本不能重复';
          return false;
        }
      });
      return rst;
    }

    //添加记录
    function addFunction(){
      var newData = {b : 0};
      store.addAt(newData,0);
      editing.edit(newData,'a'); //添加记录后，直接编辑
    }
    //删除选中的记录
    function delFunction(){
      var selections = grid.getSelection();
      store.remove(selections);
    }          
  });
</script>